{"action":"created","issue":{"url":"https://api.github.com/repos/livereviewbot/glabmig/issues/2","repository_url":"https://api.github.com/repos/livereviewbot/glabmig","labels_url":"https://api.github.com/repos/livereviewbot/glabmig/issues/2/labels{/name}","comments_url":"https://api.github.com/repos/livereviewbot/glabmig/issues/2/comments","events_url":"https://api.github.com/repos/livereviewbot/glabmig/issues/2/events","html_url":"https://github.com/livereviewbot/glabmig/pull/2","id":3306135728,"node_id":"PR_kwDOPR9M4c6i3pt0","number":2,"title":"attempt to find a suitable base commit from which to branch when scaf…","user":{"login":"shrsv","id":796107,"node_id":"MDQ6VXNlcjc5NjEwNw==","avatar_url":"https://avatars.githubusercontent.com/u/796107?v=4","gravatar_id":"","url":"https://api.github.com/users/shrsv","html_url":"https://github.com/shrsv","followers_url":"https://api.github.com/users/shrsv/followers","following_url":"https://api.github.com/users/shrsv/following{/other_user}","gists_url":"https://api.github.com/users/shrsv/gists{/gist_id}","starred_url":"https://api.github.com/users/shrsv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shrsv/subscriptions","organizations_url":"https://api.github.com/users/shrsv/orgs","repos_url":"https://api.github.com/users/shrsv/repos","events_url":"https://api.github.com/users/shrsv/events{/privacy}","received_events_url":"https://api.github.com/users/shrsv/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2025-08-09T09:09:01Z","updated_at":"2025-10-11T13:18:55Z","closed_at":null,"author_association":"COLLABORATOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/livereviewbot/glabmig/pulls/2","html_url":"https://github.com/livereviewbot/glabmig/pull/2","diff_url":"https://github.com/livereviewbot/glabmig/pull/2.diff","patch_url":"https://github.com/livereviewbot/glabmig/pull/2.patch","merged_at":null},"body":"…folding a PR branch, should now handle merge commits","reactions":{"url":"https://api.github.com/repos/livereviewbot/glabmig/issues/2/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/livereviewbot/glabmig/issues/2/timeline","performed_via_github_app":null,"state_reason":null},"comment":{"url":"https://api.github.com/repos/livereviewbot/glabmig/issues/comments/3393323646","html_url":"https://github.com/livereviewbot/glabmig/pull/2#issuecomment-3393323646","issue_url":"https://api.github.com/repos/livereviewbot/glabmig/issues/2","id":3393323646,"node_id":"IC_kwDOPR9M4c7KQgJ-","user":{"login":"livereviewbot","id":222574465,"node_id":"U_kgDODUQ3gQ","avatar_url":"https://avatars.githubusercontent.com/u/222574465?v=4","gravatar_id":"","url":"https://api.github.com/users/livereviewbot","html_url":"https://github.com/livereviewbot","followers_url":"https://api.github.com/users/livereviewbot/followers","following_url":"https://api.github.com/users/livereviewbot/following{/other_user}","gists_url":"https://api.github.com/users/livereviewbot/gists{/gist_id}","starred_url":"https://api.github.com/users/livereviewbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/livereviewbot/subscriptions","organizations_url":"https://api.github.com/users/livereviewbot/orgs","repos_url":"https://api.github.com/users/livereviewbot/repos","events_url":"https://api.github.com/users/livereviewbot/events{/privacy}","received_events_url":"https://api.github.com/users/livereviewbot/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-10-11T13:18:55Z","updated_at":"2025-10-11T13:18:55Z","body":"# Refactor and Enhancement of GitLab to GitHub Migration Tool\n\n## Overview\nThis change focuses on refactoring the existing GitLab to GitHub migration tool to improve code organization, error handling, and testability. The original code related to migrating merge requests has been replaced with logging. The changes also introduce various helper functions for interacting with the GitLab and GitHub APIs, along with utility functions and a simple object cache.\n\n## Key Changes\n- **Code Organization**: Significant improvements to code organization through the extraction of logic into separate functions for signal handling, HTTP client setup, API client setup, project loading, and configuration parsing.\n- **Error Handling**: Enhanced error handling by returning errors instead of exiting directly and using `%w` for error wrapping to preserve context.  Also, added thread-safe error counting using `atomic.Int32`.\n- **API Interaction**: Introduction of helper functions for interacting with GitLab and GitHub APIs, including functions for finding GitLab projects, listing merge requests and commits, retrieving GitHub user details, performing GitHub searches, and retrieving specific GitHub pull requests.\n- **Concurrency Management**: Utilization of `errgroup` for simplified error handling and concurrency management.\n- **Input Validation**: Added input validation for GitLab project path format.\n- **Performance**: Pre-allocation of slices for performance optimization (e.g., `results` slice).\n\n## Impact\n- **Functionality**: The migration process is now more robust due to improved error handling and logging. The introduction of helper functions facilitates easier interaction with GitLab and GitHub APIs.  The tool is now more modular and testable. The core migration logic for merge requests has been removed and replaced with logging, indicating a potential shift in focus or deferral of that functionality.\n- **Risk**: While the refactoring improves the codebase, there are several areas that introduce potential risks:\n    - **Error Context**: Not using `%w` consistently for wrapping errors could lead to loss of error context.\n    - **Rate Limiting**: The rate limit handling logic may need further refinement, including better error messages and retry mechanisms.\n    - **Concurrency**: The use of `sync.Map` should be evaluated for its actual performance benefit versus the existing mutex-based approach.\n    - **Temporary Branch Names**: The generation of temporary branch names could lead to collisions if not handled carefully.\n    - **Error Masking**: The error check for \"remote already exists\" could potentially mask other legitimate errors.\n    - **Configuration**: Some hardcoded values, such as `Private` and `AllowAutoMerge`, should be made configurable.\n    - **Pagination**: The project search should include pagination to ensure all projects are found.\n","author_association":"OWNER","reactions":{"url":"https://api.github.com/repos/livereviewbot/glabmig/issues/comments/3393323646/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null},"repository":{"id":1025461473,"node_id":"R_kgDOPR9M4Q","name":"glabmig","full_name":"livereviewbot/glabmig","private":true,"owner":{"login":"livereviewbot","id":222574465,"node_id":"U_kgDODUQ3gQ","avatar_url":"https://avatars.githubusercontent.com/u/222574465?v=4","gravatar_id":"","url":"https://api.github.com/users/livereviewbot","html_url":"https://github.com/livereviewbot","followers_url":"https://api.github.com/users/livereviewbot/followers","following_url":"https://api.github.com/users/livereviewbot/following{/other_user}","gists_url":"https://api.github.com/users/livereviewbot/gists{/gist_id}","starred_url":"https://api.github.com/users/livereviewbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/livereviewbot/subscriptions","organizations_url":"https://api.github.com/users/livereviewbot/orgs","repos_url":"https://api.github.com/users/livereviewbot/repos","events_url":"https://api.github.com/users/livereviewbot/events{/privacy}","received_events_url":"https://api.github.com/users/livereviewbot/received_events","type":"User","user_view_type":"public","site_admin":false},"html_url":"https://github.com/livereviewbot/glabmig","description":null,"fork":false,"url":"https://api.github.com/repos/livereviewbot/glabmig","forks_url":"https://api.github.com/repos/livereviewbot/glabmig/forks","keys_url":"https://api.github.com/repos/livereviewbot/glabmig/keys{/key_id}","collaborators_url":"https://api.github.com/repos/livereviewbot/glabmig/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/livereviewbot/glabmig/teams","hooks_url":"https://api.github.com/repos/livereviewbot/glabmig/hooks","issue_events_url":"https://api.github.com/repos/livereviewbot/glabmig/issues/events{/number}","events_url":"https://api.github.com/repos/livereviewbot/glabmig/events","assignees_url":"https://api.github.com/repos/livereviewbot/glabmig/assignees{/user}","branches_url":"https://api.github.com/repos/livereviewbot/glabmig/branches{/branch}","tags_url":"https://api.github.com/repos/livereviewbot/glabmig/tags","blobs_url":"https://api.github.com/repos/livereviewbot/glabmig/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/livereviewbot/glabmig/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/livereviewbot/glabmig/git/refs{/sha}","trees_url":"https://api.github.com/repos/livereviewbot/glabmig/git/trees{/sha}","statuses_url":"https://api.github.com/repos/livereviewbot/glabmig/statuses/{sha}","languages_url":"https://api.github.com/repos/livereviewbot/glabmig/languages","stargazers_url":"https://api.github.com/repos/livereviewbot/glabmig/stargazers","contributors_url":"https://api.github.com/repos/livereviewbot/glabmig/contributors","subscribers_url":"https://api.github.com/repos/livereviewbot/glabmig/subscribers","subscription_url":"https://api.github.com/repos/livereviewbot/glabmig/subscription","commits_url":"https://api.github.com/repos/livereviewbot/glabmig/commits{/sha}","git_commits_url":"https://api.github.com/repos/livereviewbot/glabmig/git/commits{/sha}","comments_url":"https://api.github.com/repos/livereviewbot/glabmig/comments{/number}","issue_comment_url":"https://api.github.com/repos/livereviewbot/glabmig/issues/comments{/number}","contents_url":"https://api.github.com/repos/livereviewbot/glabmig/contents/{+path}","compare_url":"https://api.github.com/repos/livereviewbot/glabmig/compare/{base}...{head}","merges_url":"https://api.github.com/repos/livereviewbot/glabmig/merges","archive_url":"https://api.github.com/repos/livereviewbot/glabmig/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/livereviewbot/glabmig/downloads","issues_url":"https://api.github.com/repos/livereviewbot/glabmig/issues{/number}","pulls_url":"https://api.github.com/repos/livereviewbot/glabmig/pulls{/number}","milestones_url":"https://api.github.com/repos/livereviewbot/glabmig/milestones{/number}","notifications_url":"https://api.github.com/repos/livereviewbot/glabmig/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/livereviewbot/glabmig/labels{/name}","releases_url":"https://api.github.com/repos/livereviewbot/glabmig/releases{/id}","deployments_url":"https://api.github.com/repos/livereviewbot/glabmig/deployments","created_at":"2025-07-24T09:36:39Z","updated_at":"2025-07-24T09:37:19Z","pushed_at":"2025-07-24T09:53:45Z","git_url":"git://github.com/livereviewbot/glabmig.git","ssh_url":"git@github.com:livereviewbot/glabmig.git","clone_url":"https://github.com/livereviewbot/glabmig.git","svn_url":"https://github.com/livereviewbot/glabmig","homepage":null,"size":458,"stargazers_count":0,"watchers_count":0,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":0,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"private","forks":0,"open_issues":1,"watchers":0,"default_branch":"main"},"sender":{"login":"livereviewbot","id":222574465,"node_id":"U_kgDODUQ3gQ","avatar_url":"https://avatars.githubusercontent.com/u/222574465?v=4","gravatar_id":"","url":"https://api.github.com/users/livereviewbot","html_url":"https://github.com/livereviewbot","followers_url":"https://api.github.com/users/livereviewbot/followers","following_url":"https://api.github.com/users/livereviewbot/following{/other_user}","gists_url":"https://api.github.com/users/livereviewbot/gists{/gist_id}","starred_url":"https://api.github.com/users/livereviewbot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/livereviewbot/subscriptions","organizations_url":"https://api.github.com/users/livereviewbot/orgs","repos_url":"https://api.github.com/users/livereviewbot/repos","events_url":"https://api.github.com/users/livereviewbot/events{/privacy}","received_events_url":"https://api.github.com/users/livereviewbot/received_events","type":"User","user_view_type":"public","site_admin":false}}