[
  {
    "old_path": "liveapi-backend/prompt/prompt.go",
    "new_path": "liveapi-backend/prompt/prompt.go",
    "hunks": [
      {
        "old_start_line": 531,
        "old_line_count": 7,
        "new_start_line": 531,
        "new_line_count": 8,
        "header_text": "The content of source files containing both route definitions and handlers is pr",
        "lines": [
          {
            "content": "    ",
            "line_type": "context",
            "old_line_no": 531,
            "new_line_no": 531
          },
          {
            "content": "      - Include version of the websocket endpoint in the path like '/v3/ws/event' if present in the path",
            "line_type": "context",
            "old_line_no": 532,
            "new_line_no": 532
          },
          {
            "content": "      - DO NOT create POST, PUT, DELETE methods etc.",
            "line_type": "context",
            "old_line_no": 533,
            "new_line_no": 533
          },
          {
            "content": "` + inheritenceExtractionSection(detectedFramework, fileDependenciesDescription) + `",
            "line_type": "deleted",
            "old_line_no": 534,
            "new_line_no": 0
          },
          {
            "content": "` + NestjsInheritanceExtractionSection(detectedFramework, fileDependenciesDescription) + `",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 534
          },
          {
            "content": "` + JavaInheritanceExtractionSection(detectedFramework, fileDependenciesDescription) + `",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 535
          },
          {
            "content": "2. **Tag Normalization and Grouping:**",
            "line_type": "context",
            "old_line_no": 535,
            "new_line_no": 536
          },
          {
            "content": "    ",
            "line_type": "context",
            "old_line_no": 536,
            "new_line_no": 537
          },
          {
            "content": "    - Apply a consistent tag naming convention to avoid duplicates and ensure logical grouping",
            "line_type": "context",
            "old_line_no": 537,
            "new_line_no": 538
          },
          {
            "content": "",
            "line_type": "context",
            "old_line_no": 538,
            "new_line_no": 539
          }
        ]
      }
    ]
  },
  {
    "old_path": "liveapi-backend/prompt/subPrompt.go",
    "new_path": "liveapi-backend/prompt/subPrompt.go",
    "hunks": [
      {
        "old_start_line": 386,
        "old_line_count": 6,
        "new_start_line": 386,
        "new_line_count": 126,
        "header_text": "func flaskProjectBlueprintSection(detectedFramework string) string {",
        "lines": [
          {
            "content": "\t}",
            "line_type": "context",
            "old_line_no": 386,
            "new_line_no": 386
          },
          {
            "content": "\treturn \"\"",
            "line_type": "context",
            "old_line_no": 387,
            "new_line_no": 387
          },
          {
            "content": "}",
            "line_type": "context",
            "old_line_no": 388,
            "new_line_no": 388
          },
          {
            "content": "",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 389
          },
          {
            "content": "func JavaInheritanceExtractionSection(detectedFramework string, fileDependenciesDescription string) string {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 390
          },
          {
            "content": "\t/*",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 391
          },
          {
            "content": "\t\tInheritance Extraction Section is a prompt section that provides instructions on how to handle inheritance in API endpoints.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 392
          },
          {
            "content": "\t\tIt is specifically designed for frameworks like JavaScript/Nestjs and Java/quarkus,",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 393
          },
          {
            "content": "\t\twhere API endpoints can be inherited from base classes or parent controllers.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 394
          },
          {
            "content": "\t\tIt guides to identify inherited endpoints and merge them correctly in the OpenAPI JSON output",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 395
          },
          {
            "content": "\t*/",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 396
          },
          {
            "content": "\tif fileDependenciesDescription == \"\" {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 397
          },
          {
            "content": "\t\treturn \"\"",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 398
          },
          {
            "content": "\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 399
          },
          {
            "content": "\tif detectedFramework == \"Java/quarkus\" || detectedFramework == \"Java/jersey\" {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 400
          },
          {
            "content": "\t\treturn `",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 401
          },
          {
            "content": "1.2 **API Inheritance Handling**",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 402
          },
          {
            "content": "    ",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 403
          },
          {
            "content": "    **How to identify API inherited endpoints:**",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 404
          },
          {
            "content": "    1.  **Understand Class Relation:** ",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 405
          },
          {
            "content": "",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 406
          },
          {
            "content": "      - **Look at the File Relation:**",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 407
          },
          {
            "content": "        - For Each Files File Relation is provided.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 408
          },
          {
            "content": "\t\t\tExample:",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 409
          },
          {
            "content": "\t\t\t\t/lib/student/student.controller.java inherits APIs present in /lib/core/main/main.controller.java.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 410
          },
          {
            "content": "        - In Example /lib/student/student.controller.java is child file and /lib/core/main/main.controller.java. is parent file.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 411
          },
          {
            "content": "        ",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 412
          },
          {
            "content": "\t  - **Identify Relation**",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 413
          },
          {
            "content": "        - Identify any interfaces extend another class in the source file.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 414
          },
          {
            "content": "        - Start by reading each source file and understanding the class definition:",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 415
          },
          {
            "content": "          Example1:",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 416
          },
          {
            "content": "\t\t    FilePath: /lib/student/student.controller.java",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 417
          },
          {
            "content": "            18 @Path(\"student\")",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 418
          },
          {
            "content": "            19 public interfaces StudentController extends MainController\u003cCustomStudent\u003e {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 419
          },
          {
            "content": "\t\t  Example2:",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 420
          },
          {
            "content": "\t\t  \tFilePath: /lib/student/student.controller.java",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 421
          },
          {
            "content": "\t\t  \t18 @Path(\"student\")",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 422
          },
          {
            "content": "\t\t\t19 public class StudentController extends MainController\u003cCustomStudent\u003e {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 423
          },
          {
            "content": "        - In the both example, 'StudentController' extend 'MainController'.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 424
          },
          {
            "content": "        - From these observations, the parent class/interface is 'MainController' and the child class/interface is 'StudentController'.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 425
          },
          {
            "content": "",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 426
          },
          {
            "content": "\t2. **Identify Base API Endpoint**",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 427
          },
          {
            "content": "      - From the child class/interface, identify the base API endpoint.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 428
          },
          {
            "content": "        Example:",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 429
          },
          {
            "content": "        Child File:",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 430
          },
          {
            "content": "          18 @Path(\"student\")",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 431
          },
          {
            "content": "          19 public class StudentController extends MainController\u003cCustomStudent\u003e {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 432
          },
          {
            "content": "\t\t- From the above example in /lib/student/student.controller.java, the base API endpoint 'student'.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 433
          },
          {
            "content": "      \t- Similarly, identify the base API endpoint for each child class/interface.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 434
          },
          {
            "content": "",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 435
          },
          {
            "content": "    3. **Identified Endpoints under Parent Class/interface:**",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 436
          },
          {
            "content": "      - In the provided source files, look at the file content of the parent class/interface.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 437
          },
          {
            "content": "        Example1:",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 438
          },
          {
            "content": "\t\t  \tFilePath: /lib/core/main/main.controller.java",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 439
          },
          {
            "content": "      \t    19 export abstract class MainController\u003cT extends BaseEntity\u003e {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 440
          },
          {
            "content": "            39      @GET",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 441
          },
          {
            "content": "            40      @Path(\"/count\")   getCount(...) { ... } .....",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 442
          },
          {
            "content": "            ....",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 443
          },
          {
            "content": "            }",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 444
          },
          {
            "content": "\t\tExample2:",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 445
          },
          {
            "content": "\t\t\tFilePath: /lib/core/main/main.controller.java",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 446
          },
          {
            "content": "\t\t\t19 public interface MainController\u003cT extends BaseEntity\u003e {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 447
          },
          {
            "content": "\t\t\t39      @GET",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 448
          },
          {
            "content": "\t\t\t40      @Path(\"/count\")   getCount(...) { ... } .....",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 449
          },
          {
            "content": "\t\t\t....",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 450
          },
          {
            "content": "\t\t\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 451
          },
          {
            "content": "      \t- In the example parent class/interface is 'MainController' present in file '/lib/core/main/main.controller.java'",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 452
          },
          {
            "content": "        - Inside the parent class/interface, look for methods decorated with HTTP method decorators (@GET, @POST, @PUT, @DELETE, @Path, etc.). ",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 453
          },
          {
            "content": "        - These decorators define the routes.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 454
          },
          {
            "content": "        - Construct the full route by concatenating the extending parent class route prefix with the relative route path from the parent class API endpoint decorator.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 455
          },
          {
            "content": "        - From Above example Route will be 'GET /student/count'....",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 456
          },
          {
            "content": "",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 457
          },
          {
            "content": "      **IMPORTANT INSTRUCTION**",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 458
          },
          {
            "content": "        - Include every HTTP endpoint defined with method decorators (@GET, @PUT, @POST, etc.) in the parent class in the output for the extending API endpoint.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 459
          },
          {
            "content": "        - Unless the extending class/interface defines its own method with the **same HTTP method and route path**, which overrides the parent API endpoint.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 460
          },
          {
            "content": "      \t- If child class base API decalred in @Path('student').",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 461
          },
          {
            "content": "        - Base API endpoint '/student' and this extends parent api's.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 462
          },
          {
            "content": "      ",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 463
          },
          {
            "content": "      **Rules for Merging API Endpoints**",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 464
          },
          {
            "content": "        - Endpoints **only defined** in the extending class appear **only under that child class output**.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 465
          },
          {
            "content": "            For example, \"/student/school/:id\" exists only in the 'StudentController' output because it is defined only there.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 466
          },
          {
            "content": "        - When both parent and child classes define an endpoint with the same HTTP method and route path, **use only the child class API endpoint implementation** in the output, replacing the inherited API.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 467
          },
          {
            "content": "        - Endpoints defined in the Parent class **must never appear standalone**; always show them merged and prefixed under each extending parent class.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 468
          },
          {
            "content": "        - Apply this merging logic to **every extending parent class** in the project hierarchy.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 469
          },
          {
            "content": "        - Collect metadata such as summary, description, tags, and source files from both base and extending controllers for each merged endpoint.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 470
          },
          {
            "content": "        - Maintain distinct entries per HTTP method under endpoints, each with their appropriate route and merged metadata.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 471
          },
          {
            "content": "\t\t",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 472
          },
          {
            "content": "    4. **Example Output:**",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 473
          },
          {
            "content": "        - For the above example, the output for StudentController would include:",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 474
          },
          {
            "content": "        - After identifying and merging inherited endpoints with **File Relation:** and Source Files Example:",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 475
          },
          {
            "content": "    **Expected inherited 'api_endpoints':**",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 476
          },
          {
            "content": "    {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 477
          },
          {
            "content": "      \"api_endpoints\": [",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 478
          },
          {
            "content": "        {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 479
          },
          {
            "content": "          \"api_path\": \"/student/count\",",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 480
          },
          {
            "content": "          \"methods\": {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 481
          },
          {
            "content": "            \"get\": {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 482
          },
          {
            "content": "              \"summary\": \"GET student count\",",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 483
          },
          {
            "content": "              \"description\": \"GET the total count of all student ........\",",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 484
          },
          {
            "content": "              \"tags\": [\"CustomStudent\", \"MainController\"], /*Have both parent and child class tags.*/",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 485
          },
          {
            "content": "              \"x-sourceFiles\": [/* include both parent and child source-file objects with fileName, filePath, handlerName, lineNumber */ ",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 486
          },
          {
            "content": "                {         ",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 487
          },
          {
            "content": "                  \"fileName\": \"main.controller.java\",",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 488
          },
          {
            "content": "                  \"filePath\": \"/lib/core/main/main.controller.java\",",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 489
          },
          {
            "content": "                  \"handlerName\": \"getCount\",",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 490
          },
          {
            "content": "                  \"lineNumber\": 40",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 491
          },
          {
            "content": "                },",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 492
          },
          {
            "content": "                {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 493
          },
          {
            "content": "                  \"fileName\": \"student.controller.java\",",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 494
          },
          {
            "content": "                  \"filePath\": \"/lib/student/student.controller.java\",",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 495
          },
          {
            "content": "                  \"handlerName\": \"StudentController\",",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 496
          },
          {
            "content": "                  \"lineNumber\": 19",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 497
          },
          {
            "content": "                }",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 498
          },
          {
            "content": "              ]",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 499
          },
          {
            "content": "            } ",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 500
          },
          {
            "content": "          }",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 501
          },
          {
            "content": "        },",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 502
          },
          {
            "content": "      ]",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 503
          },
          {
            "content": "    }",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 504
          },
          {
            "content": "    `",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 505
          },
          {
            "content": "\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 506
          },
          {
            "content": "\treturn \"\"",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 507
          },
          {
            "content": "}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 508
          },
          {
            "content": "func fileDependenciesDescriptionStructure(fileDependenciesDescription string) string {",
            "line_type": "context",
            "old_line_no": 389,
            "new_line_no": 509
          },
          {
            "content": "\tif fileDependenciesDescription == \"\" {",
            "line_type": "context",
            "old_line_no": 390,
            "new_line_no": 510
          },
          {
            "content": "\t\treturn \"\"",
            "line_type": "context",
            "old_line_no": 391,
            "new_line_no": 511
          }
        ]
      },
      {
        "old_start_line": 402,
        "old_line_count": 7,
        "new_start_line": 522,
        "new_line_count": 7,
        "header_text": "Make sure to include the dependent file while identifying API endpoints.",
        "lines": [
          {
            "content": "`",
            "line_type": "context",
            "old_line_no": 402,
            "new_line_no": 522
          },
          {
            "content": "}",
            "line_type": "context",
            "old_line_no": 403,
            "new_line_no": 523
          },
          {
            "content": "",
            "line_type": "context",
            "old_line_no": 404,
            "new_line_no": 524
          },
          {
            "content": "func inheritenceExtractionSection(detectedFramework string, fileDependenciesDescription string) string {",
            "line_type": "deleted",
            "old_line_no": 405,
            "new_line_no": 0
          },
          {
            "content": "func NestjsInheritanceExtractionSection(detectedFramework string, fileDependenciesDescription string) string {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 525
          },
          {
            "content": "\t/*",
            "line_type": "context",
            "old_line_no": 406,
            "new_line_no": 526
          },
          {
            "content": "\t\tInheritance Extraction Section is a prompt section that provides instructions on how to handle inheritance in API endpoints.",
            "line_type": "context",
            "old_line_no": 407,
            "new_line_no": 527
          },
          {
            "content": "\t\tIt is specifically designed for frameworks like JavaScript/Nestjs and Java/quarkus,",
            "line_type": "context",
            "old_line_no": 408,
            "new_line_no": 528
          }
        ]
      },
      {
        "old_start_line": 412,
        "old_line_count": 7,
        "new_start_line": 532,
        "new_line_count": 7,
        "header_text": "func inheritenceExtractionSection(detectedFramework string, fileDependenciesDesc",
        "lines": [
          {
            "content": "\tif fileDependenciesDescription == \"\" {",
            "line_type": "context",
            "old_line_no": 412,
            "new_line_no": 532
          },
          {
            "content": "\t\treturn \"\"",
            "line_type": "context",
            "old_line_no": 413,
            "new_line_no": 533
          },
          {
            "content": "\t}",
            "line_type": "context",
            "old_line_no": 414,
            "new_line_no": 534
          },
          {
            "content": "\tif detectedFramework == \"JavaScript/Nestjs\" || detectedFramework == \"Java/quarkus\" || detectedFramework == \"Java/jersey\" {",
            "line_type": "deleted",
            "old_line_no": 415,
            "new_line_no": 0
          },
          {
            "content": "\tif detectedFramework == \"JavaScript/Nestjs\" {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 535
          },
          {
            "content": "\t\treturn `",
            "line_type": "context",
            "old_line_no": 416,
            "new_line_no": 536
          },
          {
            "content": "1.2 **API Endpoint Inheritance \u0026 Extension Handling**",
            "line_type": "context",
            "old_line_no": 417,
            "new_line_no": 537
          },
          {
            "content": "    ",
            "line_type": "context",
            "old_line_no": 418,
            "new_line_no": 538
          }
        ]
      },
      {
        "old_start_line": 601,
        "old_line_count": 11,
        "new_start_line": 721,
        "new_line_count": 6,
        "header_text": "func inheritenceExtractionSection(detectedFramework string, fileDependenciesDesc",
        "lines": [
          {
            "content": "\t\t},",
            "line_type": "context",
            "old_line_no": 601,
            "new_line_no": 721
          },
          {
            "content": "      ]",
            "line_type": "context",
            "old_line_no": 602,
            "new_line_no": 722
          },
          {
            "content": "    }",
            "line_type": "context",
            "old_line_no": 603,
            "new_line_no": 723
          },
          {
            "content": "    Note:",
            "line_type": "deleted",
            "old_line_no": 604,
            "new_line_no": 0
          },
          {
            "content": "    - The output must include all inherited endpoints from the base controller, merged under each extending parent class.",
            "line_type": "deleted",
            "old_line_no": 605,
            "new_line_no": 0
          },
          {
            "content": "    - Each endpoint must have its own entry with the correct HTTP method, path, and metadata.",
            "line_type": "deleted",
            "old_line_no": 606,
            "new_line_no": 0
          },
          {
            "content": "    - Ensure that the final output is a complete OpenAPI JSON specification, including all merged endpoints and their metadata.",
            "line_type": "deleted",
            "old_line_no": 607,
            "new_line_no": 0
          },
          {
            "content": "    - Don't skip any child class API endpoints.",
            "line_type": "deleted",
            "old_line_no": 608,
            "new_line_no": 0
          },
          {
            "content": "    `",
            "line_type": "context",
            "old_line_no": 609,
            "new_line_no": 724
          },
          {
            "content": "\t}",
            "line_type": "context",
            "old_line_no": 610,
            "new_line_no": 725
          },
          {
            "content": "\treturn \"\"",
            "line_type": "context",
            "old_line_no": 611,
            "new_line_no": 726
          },
          {
            "content": "",
            "line_type": "context",
            "old_line_no": 612,
            "new_line_no": 727
          }
        ]
      }
    ]
  },
  {
    "old_path": "liveapi-backend/qmanager/repodag.go",
    "new_path": "liveapi-backend/qmanager/repodag.go",
    "hunks": [
      {
        "old_start_line": 94,
        "old_line_count": 7,
        "new_start_line": 94,
        "new_line_count": 7,
        "header_text": "func BuildCompleteMetadata(ctx context.Context, repoData *RepoData, jobID string",
        "lines": [
          {
            "content": "\tif repoData.PathToContent == nil {",
            "line_type": "context",
            "old_line_no": 94,
            "new_line_no": 94
          },
          {
            "content": "\t\treturn nil, nil, nil, errors.New(\"PathToContent cannot be nil\")",
            "line_type": "context",
            "old_line_no": 95,
            "new_line_no": 95
          },
          {
            "content": "\t}",
            "line_type": "context",
            "old_line_no": 96,
            "new_line_no": 96
          },
          {
            "content": "",
            "line_type": "deleted",
            "old_line_no": 97,
            "new_line_no": 0
          },
          {
            "content": "\tvar edges []Edge",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 97
          },
          {
            "content": "\t// Prepare gemini client once",
            "line_type": "context",
            "old_line_no": 98,
            "new_line_no": 98
          },
          {
            "content": "\tmodel := gemini.InitGeminiClient(ctx)",
            "line_type": "context",
            "old_line_no": 99,
            "new_line_no": 99
          },
          {
            "content": "\tgeminiConfig, err := utils.Configuration()",
            "line_type": "context",
            "old_line_no": 100,
            "new_line_no": 100
          }
        ]
      },
      {
        "old_start_line": 118,
        "old_line_count": 7,
        "new_start_line": 118,
        "new_line_count": 7,
        "header_text": "func BuildCompleteMetadata(ctx context.Context, repoData *RepoData, jobID string",
        "lines": [
          {
            "content": "\tidToNode := make(map[string]ClassNode)",
            "line_type": "context",
            "old_line_no": 118,
            "new_line_no": 118
          },
          {
            "content": "\tfileParents := make(map[string]map[string]bool)",
            "line_type": "context",
            "old_line_no": 119,
            "new_line_no": 119
          },
          {
            "content": "\tidToToken := make(map[string]int)",
            "line_type": "context",
            "old_line_no": 120,
            "new_line_no": 120
          },
          {
            "content": "\tvar edges []Edge",
            "line_type": "deleted",
            "old_line_no": 121,
            "new_line_no": 0
          },
          {
            "content": "",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 121
          },
          {
            "content": "\tnodeHasChildren := make(map[string]bool)",
            "line_type": "context",
            "old_line_no": 122,
            "new_line_no": 122
          },
          {
            "content": "\treferencedNodeIDs := make(map[string]bool)",
            "line_type": "context",
            "old_line_no": 123,
            "new_line_no": 123
          },
          {
            "content": "",
            "line_type": "context",
            "old_line_no": 124,
            "new_line_no": 124
          }
        ]
      },
      {
        "old_start_line": 142,
        "old_line_count": 7,
        "new_start_line": 142,
        "new_line_count": 7,
        "header_text": "func BuildCompleteMetadata(ctx context.Context, repoData *RepoData, jobID string",
        "lines": [
          {
            "content": "",
            "line_type": "context",
            "old_line_no": 142,
            "new_line_no": 142
          },
          {
            "content": "\t\tclassEntry.Path = normalizePath(repoData.ProjectRoot, classEntry.Path)",
            "line_type": "context",
            "old_line_no": 143,
            "new_line_no": 143
          },
          {
            "content": "\t\tif _, found := repoData.PathToContent[classEntry.Path]; !found {",
            "line_type": "context",
            "old_line_no": 144,
            "new_line_no": 144
          },
          {
            "content": "\t\t\tlog.Debug().Str(\"jobID\", jobID).Str(\"path\", classEntry.Path).Msg(\"Skipping - file content not found\")",
            "line_type": "deleted",
            "old_line_no": 145,
            "new_line_no": 0
          },
          {
            "content": "\t\t\t//log.Debug().Str(\"jobID\", jobID).Str(\"path\", classEntry.Path).Msg(\"Skipping - file content not found\")",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 145
          },
          {
            "content": "\t\t\tcontinue",
            "line_type": "context",
            "old_line_no": 146,
            "new_line_no": 146
          },
          {
            "content": "\t\t}",
            "line_type": "context",
            "old_line_no": 147,
            "new_line_no": 147
          },
          {
            "content": "",
            "line_type": "context",
            "old_line_no": 148,
            "new_line_no": 148
          }
        ]
      },
      {
        "old_start_line": 187,
        "old_line_count": 6,
        "new_start_line": 187,
        "new_line_count": 7,
        "header_text": "func BuildCompleteMetadata(ctx context.Context, repoData *RepoData, jobID string",
        "lines": [
          {
            "content": "\t\t\t\tidToToken[fileID] = -1",
            "line_type": "context",
            "old_line_no": 187,
            "new_line_no": 187
          },
          {
            "content": "\t\t\t\tlog.Debug().Str(\"jobID\", jobID).Str(\"file\", classEntry.Path).Err(terr).Msg(\"CountTokens failed (recorded -1)\")",
            "line_type": "context",
            "old_line_no": 188,
            "new_line_no": 188
          },
          {
            "content": "\t\t\t} else {",
            "line_type": "context",
            "old_line_no": 189,
            "new_line_no": 189
          },
          {
            "content": "\t\t\t\tlog.Debug().Str(\"jobID\", jobID).Str(\"file\", classEntry.Path).Int(\"tokens\", tokenCount).Msg(\"CountTokens succeeded\")",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 190
          },
          {
            "content": "\t\t\t\tidToToken[fileID] = tokenCount",
            "line_type": "context",
            "old_line_no": 190,
            "new_line_no": 191
          },
          {
            "content": "\t\t\t\tmetadata.TokenCountByFileID[fileID] = tokenCount",
            "line_type": "context",
            "old_line_no": 191,
            "new_line_no": 192
          },
          {
            "content": "\t\t\t}",
            "line_type": "context",
            "old_line_no": 192,
            "new_line_no": 193
          }
        ]
      },
      {
        "old_start_line": 199,
        "old_line_count": 7,
        "new_start_line": 200,
        "new_line_count": 8,
        "header_text": "func BuildCompleteMetadata(ctx context.Context, repoData *RepoData, jobID string",
        "lines": [
          {
            "content": "\t\tInt(\"skippedNotClass\", skippedNotClass).",
            "line_type": "context",
            "old_line_no": 199,
            "new_line_no": 200
          },
          {
            "content": "\t\tInt(\"totalLines\", totalLines).",
            "line_type": "context",
            "old_line_no": 200,
            "new_line_no": 201
          },
          {
            "content": "\t\tMsg(\"Parsed valid class/interface entries\")",
            "line_type": "context",
            "old_line_no": 201,
            "new_line_no": 202
          },
          {
            "content": "",
            "line_type": "deleted",
            "old_line_no": 202,
            "new_line_no": 0
          },
          {
            "content": "\t// Found All Interfaces and Classes nodes",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 203
          },
          {
            "content": "\t// Second pass: create edges based on parents",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 204
          },
          {
            "content": "\tfor fileID := range idToNode {",
            "line_type": "context",
            "old_line_no": 203,
            "new_line_no": 205
          },
          {
            "content": "\t\tparentSet := fileParents[fileID]",
            "line_type": "context",
            "old_line_no": 204,
            "new_line_no": 206
          },
          {
            "content": "\t\tif len(parentSet) == 0 {",
            "line_type": "context",
            "old_line_no": 205,
            "new_line_no": 207
          }
        ]
      },
      {
        "old_start_line": 255,
        "old_line_count": 9,
        "new_start_line": 257,
        "new_line_count": 9,
        "header_text": "func BuildCompleteMetadata(ctx context.Context, repoData *RepoData, jobID string",
        "lines": [
          {
            "content": "\t}",
            "line_type": "context",
            "old_line_no": 255,
            "new_line_no": 257
          },
          {
            "content": "\tlog.Info().Str(\"jobID\", jobID).Int(\"preparedFiles\", len(metadata.FileIDByPath)).Msg(\"Metadata build complete\")",
            "line_type": "context",
            "old_line_no": 256,
            "new_line_no": 258
          },
          {
            "content": "",
            "line_type": "context",
            "old_line_no": 257,
            "new_line_no": 259
          },
          {
            "content": "\tchainLeafMap, cerr := buildDependencyChains(batchBuilder, jobID)",
            "line_type": "deleted",
            "old_line_no": 258,
            "new_line_no": 0
          },
          {
            "content": "\tif cerr != nil {",
            "line_type": "deleted",
            "old_line_no": 259,
            "new_line_no": 0
          },
          {
            "content": "\t\treturn nil, nil, nil, fmt.Errorf(\"failed to get dependency chains: %w\", cerr)",
            "line_type": "deleted",
            "old_line_no": 260,
            "new_line_no": 0
          },
          {
            "content": "\tchainLeafMap, chainErr := buildDependencyChains(batchBuilder, jobID)",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 260
          },
          {
            "content": "\tif chainErr != nil {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 261
          },
          {
            "content": "\t\treturn nil, nil, nil, fmt.Errorf(\"failed to get dependency chains: %w\", chainErr)",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 262
          },
          {
            "content": "\t}",
            "line_type": "context",
            "old_line_no": 261,
            "new_line_no": 263
          },
          {
            "content": "\tlog.Debug().Str(\"jobID\", jobID).Int(\"leafCount\", len(chainLeafMap)).Msg(\"Collected dependency chains\")",
            "line_type": "context",
            "old_line_no": 262,
            "new_line_no": 264
          },
          {
            "content": "",
            "line_type": "context",
            "old_line_no": 263,
            "new_line_no": 265
          }
        ]
      },
      {
        "old_start_line": 433,
        "old_line_count": 8,
        "new_start_line": 435,
        "new_line_count": 23,
        "header_text": "func collectUnbatched(batchBuilder *BatchBuilder, allRoutes []string, jobID stri",
        "lines": [
          {
            "content": "\treturn unbatched",
            "line_type": "context",
            "old_line_no": 433,
            "new_line_no": 435
          },
          {
            "content": "}",
            "line_type": "context",
            "old_line_no": 434,
            "new_line_no": 436
          },
          {
            "content": "",
            "line_type": "context",
            "old_line_no": 435,
            "new_line_no": 437
          },
          {
            "content": "// processDependencyChains iterates through leaf nodes, builds dependency chains, and organizes them into batches",
            "line_type": "deleted",
            "old_line_no": 436,
            "new_line_no": 0
          },
          {
            "content": "// while respecting token limits. It handles oversized chains by isolating them and manages batch transitions.",
            "line_type": "deleted",
            "old_line_no": 437,
            "new_line_no": 0
          },
          {
            "content": "// deterministicChainKey builds a stable string key for a dependency chain by joining",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 438
          },
          {
            "content": "// its file paths (falls back to the file ID if the path is missing). Use this key",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 439
          },
          {
            "content": "// to sort chains deterministically.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 440
          },
          {
            "content": "func processDependencyChains(chain DependencyChain, idToPath map[string]string) string {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 441
          },
          {
            "content": "\tparts := make([]string, 0, len(chain.ChainIDs))",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 442
          },
          {
            "content": "\tfor _, id := range chain.ChainIDs {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 443
          },
          {
            "content": "\t\tif p, ok := idToPath[id]; ok \u0026\u0026 p != \"\" {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 444
          },
          {
            "content": "\t\t\tparts = append(parts, p)",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 445
          },
          {
            "content": "\t\t} else {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 446
          },
          {
            "content": "\t\t\tparts = append(parts, id)",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 447
          },
          {
            "content": "\t\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 448
          },
          {
            "content": "\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 449
          },
          {
            "content": "\treturn strings.Join(parts, \"|\")",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 450
          },
          {
            "content": "}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 451
          },
          {
            "content": "",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 452
          },
          {
            "content": "// ProcessDependencyChains iterates through leaf nodes in a deterministic, sorted order.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 453
          },
          {
            "content": "// It sorts leaf IDs by their file path and sorts chains per-leaf deterministically too.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 454
          },
          {
            "content": "func ProcessDependencyChains(batchBuilder *BatchBuilder, maxTokens int, chainLeafMap map[string][]DependencyChain, jobID string) error {",
            "line_type": "context",
            "old_line_no": 438,
            "new_line_no": 455
          },
          {
            "content": "\tif batchBuilder == nil {",
            "line_type": "context",
            "old_line_no": 439,
            "new_line_no": 456
          },
          {
            "content": "\t\treturn errors.New(\"builder cannot be nil\")",
            "line_type": "context",
            "old_line_no": 440,
            "new_line_no": 457
          }
        ]
      },
      {
        "old_start_line": 442,
        "old_line_count": 10,
        "new_start_line": 459,
        "new_line_count": 31,
        "header_text": "func ProcessDependencyChains(batchBuilder *BatchBuilder, maxTokens int, chainLea",
        "lines": [
          {
            "content": "",
            "line_type": "context",
            "old_line_no": 442,
            "new_line_no": 459
          },
          {
            "content": "\tlog.Info().Str(\"jobID\", jobID).Int(\"maxTokens\", maxTokens).Msg(\"Processing dependency chains\")",
            "line_type": "context",
            "old_line_no": 443,
            "new_line_no": 460
          },
          {
            "content": "",
            "line_type": "context",
            "old_line_no": 444,
            "new_line_no": 461
          },
          {
            "content": "\t// Build a deterministic (sorted) order of leaf IDs using file paths.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 462
          },
          {
            "content": "\tleafIDs := make([]string, 0, len(chainLeafMap))",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 463
          },
          {
            "content": "\tfor leafID := range chainLeafMap {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 464
          },
          {
            "content": "\t\tleafIDs = append(leafIDs, leafID)",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 465
          },
          {
            "content": "\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 466
          },
          {
            "content": "\tsort.Slice(leafIDs, func(leftLeafIndex, rightLeafIndex int) bool {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 467
          },
          {
            "content": "\t\tleftPath := batchBuilder.InlineGroupBatchMetadata.FilePathByID[leafIDs[leftLeafIndex]]",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 468
          },
          {
            "content": "\t\trightPath := batchBuilder.InlineGroupBatchMetadata.FilePathByID[leafIDs[rightLeafIndex]]",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 469
          },
          {
            "content": "\t\treturn leftPath \u003c rightPath",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 470
          },
          {
            "content": "\t})",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 471
          },
          {
            "content": "",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 472
          },
          {
            "content": "\tcurrentBatch := RouteBatch{URLs: []URLInfo{}, FileDependencies: []FileDependencies{}}",
            "line_type": "context",
            "old_line_no": 445,
            "new_line_no": 473
          },
          {
            "content": "\tcurrentTokens := 0",
            "line_type": "context",
            "old_line_no": 446,
            "new_line_no": 474
          },
          {
            "content": "",
            "line_type": "context",
            "old_line_no": 447,
            "new_line_no": 475
          },
          {
            "content": "\tfor _, chains := range chainLeafMap {",
            "line_type": "deleted",
            "old_line_no": 448,
            "new_line_no": 0
          },
          {
            "content": "\t// Iterate in deterministic order",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 476
          },
          {
            "content": "\tfor _, leafID := range leafIDs {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 477
          },
          {
            "content": "\t\tchains := chainLeafMap[leafID]",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 478
          },
          {
            "content": "",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 479
          },
          {
            "content": "\t\t// Sort chains deterministically (by joined file-path key) so their ordering is stable.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 480
          },
          {
            "content": "\t\tsort.Slice(chains, func(leftIndex, rightIndex int) bool {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 481
          },
          {
            "content": "\t\t\tleftKey := processDependencyChains(chains[leftIndex], batchBuilder.InlineGroupBatchMetadata.FilePathByID)",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 482
          },
          {
            "content": "\t\t\trightKey := processDependencyChains(chains[rightIndex], batchBuilder.InlineGroupBatchMetadata.FilePathByID)",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 483
          },
          {
            "content": "\t\t\treturn leftKey \u003c rightKey",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 484
          },
          {
            "content": "\t\t})",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 485
          },
          {
            "content": "",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 486
          },
          {
            "content": "\t\tfor _, chain := range chains {",
            "line_type": "context",
            "old_line_no": 449,
            "new_line_no": 487
          },
          {
            "content": "\t\t\t// If this chain alone exceeds the token limit, isolate it",
            "line_type": "context",
            "old_line_no": 450,
            "new_line_no": 488
          },
          {
            "content": "\t\t\tif chain.TokenCount \u003e maxTokens {",
            "line_type": "context",
            "old_line_no": 451,
            "new_line_no": 489
          }
        ]
      },
      {
        "old_start_line": 504,
        "old_line_count": 25,
        "new_start_line": 542,
        "new_line_count": 83,
        "header_text": "func buildDependencyChains(builder *BatchBuilder, jobID string) (map[string][]De",
        "lines": [
          {
            "content": "\t}",
            "line_type": "context",
            "old_line_no": 504,
            "new_line_no": 542
          },
          {
            "content": "",
            "line_type": "context",
            "old_line_no": 505,
            "new_line_no": 543
          },
          {
            "content": "\tlog.Debug().Str(\"jobID\", jobID).Msg(\"Building chains from leaf nodes\")",
            "line_type": "context",
            "old_line_no": 506,
            "new_line_no": 544
          },
          {
            "content": "",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 545
          },
          {
            "content": "\t// 1) Collect edges to determine which nodes actually participate in relationships.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 546
          },
          {
            "content": "\tedges, err := builder.graph.Edges()",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 547
          },
          {
            "content": "\tif err != nil {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 548
          },
          {
            "content": "\t\treturn nil, fmt.Errorf(\"failed to get graph edges: %w\", err)",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 549
          },
          {
            "content": "\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 550
          },
          {
            "content": "",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 551
          },
          {
            "content": "\tusedNodeIDs := make(map[string]bool)",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 552
          },
          {
            "content": "\tfor _, e := range edges {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 553
          },
          {
            "content": "\t\tusedNodeIDs[e.Source] = true",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 554
          },
          {
            "content": "\t\tusedNodeIDs[e.Target] = true",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 555
          },
          {
            "content": "\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 556
          },
          {
            "content": "",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 557
          },
          {
            "content": "\t// If there are no edges, there are no relations to build chains from.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 558
          },
          {
            "content": "\tif len(usedNodeIDs) == 0 {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 559
          },
          {
            "content": "\t\tlog.Debug().Str(\"jobID\", jobID).Msg(\"No edges present in graph; returning empty chain map\")",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 560
          },
          {
            "content": "\t\treturn map[string][]DependencyChain{}, nil",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 561
          },
          {
            "content": "\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 562
          },
          {
            "content": "",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 563
          },
          {
            "content": "\t// 2) Get leaf IDs (sorted by file path) then filter out any leaf that is isolated (not in usedNodeIDs).",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 564
          },
          {
            "content": "\tleafIDs, err := getLeafFilePaths(builder)",
            "line_type": "context",
            "old_line_no": 507,
            "new_line_no": 565
          },
          {
            "content": "\tif err != nil {",
            "line_type": "context",
            "old_line_no": 508,
            "new_line_no": 566
          },
          {
            "content": "\t\treturn nil, fmt.Errorf(\"failed to get leaf file paths: %w\", err)",
            "line_type": "context",
            "old_line_no": 509,
            "new_line_no": 567
          },
          {
            "content": "\t}",
            "line_type": "context",
            "old_line_no": 510,
            "new_line_no": 568
          },
          {
            "content": "\tlog.Debug().Str(\"jobID\", jobID).Int(\"leafIDsFound\", len(leafIDs)).Msg(\"Leaf IDs retrieved\")",
            "line_type": "context",
            "old_line_no": 511,
            "new_line_no": 569
          },
          {
            "content": "",
            "line_type": "context",
            "old_line_no": 512,
            "new_line_no": 570
          },
          {
            "content": "\t// Use PredecessorMap to get reverse edges",
            "line_type": "deleted",
            "old_line_no": 513,
            "new_line_no": 0
          },
          {
            "content": "\tfilteredLeafIDs := make([]string, 0, len(leafIDs))",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 571
          },
          {
            "content": "\tfor _, id := range leafIDs {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 572
          },
          {
            "content": "\t\tif usedNodeIDs[id] {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 573
          },
          {
            "content": "\t\t\tfilteredLeafIDs = append(filteredLeafIDs, id)",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 574
          },
          {
            "content": "\t\t} else {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 575
          },
          {
            "content": "\t\t\tlog.Debug().Str(\"jobID\", jobID).Str(\"leafID\", id).Msg(\"Skipping isolated leaf (no relations)\")",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 576
          },
          {
            "content": "\t\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 577
          },
          {
            "content": "\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 578
          },
          {
            "content": "\tlog.Debug().Str(\"jobID\", jobID).Int(\"filteredLeafCount\", len(filteredLeafIDs)).Msg(\"Filtered leaves that participate in edges\")",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 579
          },
          {
            "content": "",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 580
          },
          {
            "content": "\t// 3) Build a pruned predecessor map that contains only nodes participating in edges.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 581
          },
          {
            "content": "\treverseEdges, err := builder.graph.PredecessorMap()",
            "line_type": "context",
            "old_line_no": 514,
            "new_line_no": 582
          },
          {
            "content": "\tif err != nil {",
            "line_type": "context",
            "old_line_no": 515,
            "new_line_no": 583
          },
          {
            "content": "\t\treturn nil, fmt.Errorf(\"failed to get predecessor map: %w\", err)",
            "line_type": "context",
            "old_line_no": 516,
            "new_line_no": 584
          },
          {
            "content": "\t}",
            "line_type": "context",
            "old_line_no": 517,
            "new_line_no": 585
          },
          {
            "content": "\tprunedReverse := make(map[string]map[string]graph.Edge[string])",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 586
          },
          {
            "content": "\tfor nodeID, parents := range reverseEdges {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 587
          },
          {
            "content": "\t\tif !usedNodeIDs[nodeID] {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 588
          },
          {
            "content": "\t\t\tcontinue",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 589
          },
          {
            "content": "\t\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 590
          },
          {
            "content": "\t\tfor parentID, edge := range parents {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 591
          },
          {
            "content": "\t\t\tif !usedNodeIDs[parentID] {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 592
          },
          {
            "content": "\t\t\t\tcontinue",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 593
          },
          {
            "content": "\t\t\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 594
          },
          {
            "content": "\t\t\tif _, ok := prunedReverse[nodeID]; !ok {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 595
          },
          {
            "content": "\t\t\t\tprunedReverse[nodeID] = make(map[string]graph.Edge[string])",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 596
          },
          {
            "content": "\t\t\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 597
          },
          {
            "content": "\t\t\tprunedReverse[nodeID][parentID] = edge",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 598
          },
          {
            "content": "\t\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 599
          },
          {
            "content": "\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 600
          },
          {
            "content": "",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 601
          },
          {
            "content": "\t// 4) Prune token map to only include nodes that are used (prevents lookups on totally isolated nodes).",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 602
          },
          {
            "content": "\tprunedTokenCounts := make(map[string]int)",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 603
          },
          {
            "content": "\tfor id, t := range builder.InlineGroupBatchMetadata.TokenCountByFileID {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 604
          },
          {
            "content": "\t\tif usedNodeIDs[id] {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 605
          },
          {
            "content": "\t\t\tprunedTokenCounts[id] = t",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 606
          },
          {
            "content": "\t\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 607
          },
          {
            "content": "\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 608
          },
          {
            "content": "",
            "line_type": "context",
            "old_line_no": 518,
            "new_line_no": 609
          },
          {
            "content": "\t// 5) Build chains from each filtered leaf using the pruned predecessor map and token counts.",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 610
          },
          {
            "content": "\tresult := make(map[string][]DependencyChain)",
            "line_type": "context",
            "old_line_no": 519,
            "new_line_no": 611
          },
          {
            "content": "\tfor _, leafID := range leafIDs {",
            "line_type": "deleted",
            "old_line_no": 520,
            "new_line_no": 0
          },
          {
            "content": "\tfor _, leafID := range filteredLeafIDs {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 612
          },
          {
            "content": "\t\tchains := buildChainsFromLeaf(",
            "line_type": "context",
            "old_line_no": 521,
            "new_line_no": 613
          },
          {
            "content": "\t\t\tleafID,",
            "line_type": "context",
            "old_line_no": 522,
            "new_line_no": 614
          },
          {
            "content": "\t\t\tbuilder.InlineGroupBatchMetadata.TokenCountByFileID,",
            "line_type": "deleted",
            "old_line_no": 523,
            "new_line_no": 0
          },
          {
            "content": "\t\t\treverseEdges,",
            "line_type": "deleted",
            "old_line_no": 524,
            "new_line_no": 0
          },
          {
            "content": "\t\t\tprunedTokenCounts,",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 615
          },
          {
            "content": "\t\t\tprunedReverse,",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 616
          },
          {
            "content": "\t\t)",
            "line_type": "context",
            "old_line_no": 525,
            "new_line_no": 617
          },
          {
            "content": "\t\tif len(chains) == 0 {",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 618
          },
          {
            "content": "\t\t\tlog.Debug().Str(\"jobID\", jobID).Str(\"leafID\", leafID).Msg(\"No chains built for leaf after pruning\")",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 619
          },
          {
            "content": "\t\t\tcontinue",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 620
          },
          {
            "content": "\t\t}",
            "line_type": "added",
            "old_line_no": 0,
            "new_line_no": 621
          },
          {
            "content": "\t\tresult[leafID] = chains",
            "line_type": "context",
            "old_line_no": 526,
            "new_line_no": 622
          },
          {
            "content": "\t\tlog.Debug().Str(\"jobID\", jobID).Str(\"leafID\", leafID).Int(\"chainsForLeaf\", len(chains)).Msg(\"Built chains for leaf\")",
            "line_type": "context",
            "old_line_no": 527,
            "new_line_no": 623
          },
          {
            "content": "\t}",
            "line_type": "context",
            "old_line_no": 528,
            "new_line_no": 624
          },
          {
            "content": "",
            "line_type": "context",
            "old_line_no": 529,
            "new_line_no": 625
          }
        ]
      }
    ]
  },
  {
    "old_path": "liveapi-backend/tests/repodag_tests/data/group_batch/current_output/current_output1/batches.json",
    "new_path": "liveapi-backend/tests/repodag_tests/data/group_batch/current_output/current_output1/batches.json",
    "hunks": null
  },
  {
    "old_path": "liveapi-backend/tests/repodag_tests/data/group_batch/current_output/current_output1/graph.png",
    "new_path": "liveapi-backend/tests/repodag_tests/data/group_batch/current_output/current_output1/graph.png",
    "hunks": null
  },
  {
    "old_path": "liveapi-backend/tests/repodag_tests/data/group_batch/current_output/current_output2/batches.json",
    "new_path": "liveapi-backend/tests/repodag_tests/data/group_batch/current_output/current_output2/batches.json",
    "hunks": null
  },
  {
    "old_path": "liveapi-backend/tests/repodag_tests/data/group_batch/current_output/current_output2/graph.png",
    "new_path": "liveapi-backend/tests/repodag_tests/data/group_batch/current_output/current_output2/graph.png",
    "hunks": null
  },
  {
    "old_path": "liveapi-backend/tests/repodag_tests/data/group_batch/current_output/current_output3/batches.json",
    "new_path": "liveapi-backend/tests/repodag_tests/data/group_batch/current_output/current_output3/batches.json",
    "hunks": null
  },
  {
    "old_path": "liveapi-backend/tests/repodag_tests/data/group_batch/current_output/current_output3/graph.png",
    "new_path": "liveapi-backend/tests/repodag_tests/data/group_batch/current_output/current_output3/graph.png",
    "hunks": null
  },
  {
    "old_path": "liveapi-backend/tests/repodag_tests/data/group_batch/input/input1/ctags.json",
    "new_path": "liveapi-backend/tests/repodag_tests/data/group_batch/input/input1/ctags.json",
    "hunks": null
  }
]
